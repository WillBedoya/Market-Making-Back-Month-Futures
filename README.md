# Market Making Algorithm for Back-Month Futures Contracts
## Brief Description
An algorithm for market making back-month futures contracts.
Libraries used include 'ib_insync', 'numpy', 'math', 'yfinance'.

## Detailed Description
The script seeks to provide liquidity in futures markets beyond the nearest-expiration contract. These contracts are usually very low in volume with larger bid/ask spreads compared to their front-month counterparts. Due to these contracts having such low volume, it is not a sufficiently profitable venture for most market making firms. However, for individual traders, these wider bid/ask spreads, coupled with the availability of hedging instruments that feature comparatively tighter spreads, can present a profitable opportunity in relation to their available capital. At the moment, this script is set up to make a market in second-month ES futures contracts, however it can be used for any publicly traded contracts.

Before placing any orders, the algorithm determines the fair value of the contracts being traded and compares it to the current market price. If the market price is less than 8 ticks away from the fair value price, the algorithm quotes a limit bid order at either the best bid or the fair value bid (whichever is lesser) and a limit sell order at either the best ask or the fair value ask (whichever is greater). The fair value bid and ask are determined by adding or subtracting an additional premium to the calculated fair value price. that the market maker collects. In a situation where the current market price significantly differs from the fair value price (i.e., greater than 8 tick difference), the algorithm simply places a bid/ask at the current best bid/ask offers. Although this mechanism strays away from writing contracts at what the futures contract SHOULD be priced at, if this was not done then a miniscule number of trades would be executed and the market maker would have no profit.

Once an order of the market maker is executed, it is quickly hedged with an equivalent amount of stock (in the case of market making ES futures, the stock will be SPY). The maximum inventory of futures contracts the market maker is willing to hold will be constrained to +/- 1 contract. 

As a last note, this program can be easily modified to market make back-month futures overnight if front-month contracts are used as a hedge. Although this approach is less grounded in traditional fundamentals, as it involves hedging one derivative with another derivative as oppposed to the underlying asset, it still appears to be profitable most of the time and may be useful for a market maker who wishes to operate outside of regular trading hours.

## Challenges
The biggest challenge for me here was less technological and more executional. It was not obvious what should be done in the case where the fair value of a futures contract does not align with the current market value (currently the market value is considerably above the fair value). This discrepancy was quite surprising; however, I recognize that an additional premium likely accounts for the longer dating of these contracts and their relative lack of liquidity due to these contracts being longer-dated. Additionally, the relative lack of liquidity in these back-month contracts may contribute to this additional premium. One obvious trade would be to short the overpriced futures and go long a replicating portfolio of stocks and bonds, which would be an entirely separate strategy from the one in this algorithm.

I figured that the best way to remedy this issue between the fair value price and market price would be to introduce a mechanism where, depending on how large the difference is between the two prices, either the fair value is used for pricing the futures contract or it is disregarded. It ends up being a trade-off between whether the market maker wants to take the risk of writing contracts far away from their intrinsic value but have more orders filled or if the market maker would rather only place orders near the fair value but risk having practically 0 orders filled.

## Results
TBD. In this section, I intend to present a comprehensive analysis of the market making strategy deployed by the script, including the frequency of these opportunities, average profit margins, and the success rate of executed trades. This analysis will highlight the effectiveness of the algorithm in real-time market conditions.
